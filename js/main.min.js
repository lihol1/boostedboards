"use strict";function saveCart(){localStorage.setItem("chosenProds",JSON.stringify(cart))}function getcartNum(){cart.length>0?(cartNum.classList.remove("hidden"),cartNum.textContent=cart.length):cartNum.classList.add("hidden")}function openModal(){Array.from(images).forEach(e=>{e.onclick=(t=>{let n=e.parentElement.nextElementSibling;n.classList.remove("hidden"),n.addEventListener("click",function(){this.classList.add("hidden"),enableScroll(t.target)}),n.querySelector(".prods__desc-block").addEventListener("click",e=>{e.stopPropagation()}),disableScroll(t.target)})})}function closeModal(){Array.from(closeIcons).forEach(function(e){e.addEventListener("click",function(t){e.closest('[data-modal="close"]').classList.add("hidden"),enableScroll(t.target)})})}function getIconState(e){let t=e[0].id.replace(/[^a-z]/g,""),n=[];Array.from(items).forEach(e=>{let t={id:e.getAttribute("id"),state:e.querySelector("[data-state]").getAttribute("class")};n.push(t)}),localStorage.setItem(`${t}-iconState`,JSON.stringify(n))}function setCartListener(e){Array.from(cartIcons).forEach(t=>{t.addEventListener("click",n=>{e.forEach(e=>{let o=n.target.closest(".prods__item").getAttribute("id");if(o===e.id)if(t.classList.contains("checked"))t.classList.remove("checked"),cart=cart.filter(e=>e.id!==o),getcartNum();else{const o=n.target.closest(".prods__item").querySelector(".prods__image"),r=o.cloneNode(!0),a=o.offsetWidth,i=o.offsetHeight,c=o.getBoundingClientRect().top,s=o.getBoundingClientRect().left;r.setAttribute("class","flyImage prods__image"),r.style.cssText=`\n                        left: ${s}px;\n                        top: ${c}px;\n                        width: ${a}px;\n                        height: ${i}px;\n                        `,document.body.append(r);const l=iconCart.getBoundingClientRect().right,d=iconCart.getBoundingClientRect().top;r.style.cssText=`\n                        left: ${l}px;\n                        top: ${d}px;\n                        width: 0;\n                        height: 0;\n                        opacity: 0.3;\n                        `,cart.push(e),t.classList.add("checked"),r.addEventListener("transitionend",function(){getcartNum(),r.remove()})}}),saveCart(),getIconState(e)})})}function animateItems(){const e=document.querySelectorAll("._anim-items");if(e.length>0){function t(t){for(let t=0;t<e.length;t++){const o=e[t],r=o.offsetHeight,a=n(o).top,i=10;let c=window.innerHeight-r/i;r>window.innerHeight&&(c=window.innerHeight-window.innerHeight/i),scrollY>a-c&&scrollY<a+r?o.classList.add("_active"):o.classList.contains("_anim-no-hide")||o.classList.remove("_active")}}function n(e){const t=e.getBoundingClientRect(),n=window.scrollX||document.documentElement.scrollLeft,o=window.scrollY||document.documentElement.scrollTop;return{top:t.top+o,left:t.left+n}}window.addEventListener("scroll",t),t()}}function initSliders(){document.querySelector(".swiper")&&new Swiper(".gallery__slider",{observer:!0,observeParents:!0,spaceBetween:50,breakpoints:{320:{slidesPerView:1,centeredSlides:!0,spaceBetween:20},768:{slidesPerView:1,spaceBetween:10},992:{slidesPerView:3,spaceBetween:10}},speed:1e3,slidesPerView:"auto",loop:!0,pagination:{el:".gallery__pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},on:{init:function(e){},slideChange:function(e){}}})}function setBtnListener(e){Array.from(prodsBtns).forEach(t=>{t.addEventListener("click",t=>{let n=t.target.closest(".prods__item").getAttribute("id"),o=t.target.parentElement.nextElementSibling;o.classList.contains("checked")||(o.classList.add("checked"),e.forEach(e=>{e.id===n&&cart.push(e)})),saveCart(),getcartNum(),getIconState(e)})})}function setIconState(){Array.from(items).forEach(e=>{for(let t=0;t<Array.from(items).length;t++)e.getAttribute("id")===savedIconState[t].id&&(e.querySelector("[data-state]").className=savedIconState[t].state)})}function disableScroll(e){const t=e.closest("body"),n=window.scrollY,o=window.innerWidth,r=t.offsetWidth;t.classList.add("fixed"),t.dataset.position=n,t.style.top=-n+"px",t.style.paddingRight=o-r+"px",header.style.paddingRight=o-r+"px"}function enableScroll(e){const t=e.closest("body"),n=parseInt(t.dataset.position);t.classList.remove("fixed"),t.style.top="auto",window.scroll({top:n,left:0}),t.style.paddingRight=0,header.style.paddingRight=0}const preloader=document.querySelector(".loader"),header=document.querySelector(".header"),burgerMenu=document.querySelector(".burger-menu"),nav=document.querySelector(".nav"),avatar=document.querySelector(".header__icon"),loginModal=document.querySelector(".login-modal"),cartNum=document.querySelector(".header__icon-num"),scrollElements=document.querySelectorAll("[data-scroll]"),giftBtn=document.querySelector(".gift-card__button"),giftCard=document.querySelector(".gift-card__body"),giftCardFront=document.querySelector(".gift-card__front"),giftCardBack=document.querySelector(".gift-card__back"),upBtn=document.querySelector(".footer__up"),cartIcons=document.getElementsByClassName("prods__cart-icon"),items=document.getElementsByClassName("prods__item"),prodsBtns=document.getElementsByClassName("prods__button"),images=document.getElementsByClassName("prods__image"),closeIcons=document.getElementsByClassName("close-icon__img"),sliderWrapper=document.querySelector(".gallery__wrapper"),slider=document.querySelector(".gallery__slider"),controllers=document.querySelectorAll(".gallery__controller"),iconCart=document.querySelector(".header__icon-cart");let cart=JSON.parse(localStorage.getItem("chosenProds"))||[],sliderItems=document.getElementsByClassName("gallery__slide");window.onload=(()=>{preloader&&document.documentElement.classList.add("loaded")}),burgerMenu.addEventListener("click",function(){nav.classList.toggle("nav--active"),burgerMenu.classList.toggle("burger-menu--active")}),window.innerWidth<992&&nav.addEventListener("click",e=>{"nav__link"!==e.target.className&&e.stopPropagation(),"nav__list"!==e.target.className&&(nav.classList.remove("nav--active"),burgerMenu.classList.remove("burger-menu--active"))}),getcartNum(),avatar.addEventListener("click",function(e){loginModal.classList.remove("hidden"),disableScroll(e.target),loginModal.querySelector(".login-modal__bg").onclick=(e=>{loginModal.addEventListener("click",function(){this.classList.add("hidden"),enableScroll(e.target)}),loginModal.querySelector(".login-modal__form").addEventListener("click",e=>{e.stopPropagation()}),disableScroll(e.target)})}),document.addEventListener("DOMContentLoaded",openModal),document.addEventListener("DOMContentLoaded",closeModal);let velocity=.3,topOffset=96;scrollElements.forEach(e=>{e.addEventListener("click",function(e){function t(e){null===a&&(a=e);let o=e-a,i=r<0?Math.max(n-o/velocity,n+r):Math.min(n+o/velocity,n+r);window.scrollTo(0,i),i!=n+r&&requestAnimationFrame(t)}e.preventDefault();let n=window.pageYOffset,o=this.dataset.scroll,r=document.querySelector("#"+`${o}`).getBoundingClientRect().top-topOffset,a=null;requestAnimationFrame(t)})}),giftBtn&&giftBtn.addEventListener("click",()=>{const e=document.querySelector(".gift-card__front img"),t=e.cloneNode(!0),n=e.offsetWidth,o=e.offsetHeight,r=e.getBoundingClientRect().top,a=e.getBoundingClientRect().left;t.setAttribute("class","flyImage prods__image"),t.style.cssText=`\n        left: ${a}px;\n        top: ${r}px;\n        width: ${n}px;\n        height: ${o}px;\n        `,document.body.append(t);const i=iconCart.getBoundingClientRect().right,c=iconCart.getBoundingClientRect().top;t.style.cssText=`\n        left: ${i}px;\n        top: ${c}px;\n        width: 0;\n        height: 0;\n        opacity: 0.3;                       \n            `,t.addEventListener("transitionend",function(){t.remove()});const s={id:"card",title:"Gift card",price:1e3,salePrice:1e3,qty:1,srcImg:"./img/gift-card/mini-gift-card.jpg"};if(cart==[])cart.push(s);else{let e,t=!1;cart.forEach(n=>{"card"==n.id&&(t=!0,e=cart.indexOf(n))}),1==t&&cart[e].qty++,0==t&&cart.push(s)}saveCart(),getcartNum()}),giftCard&&window.matchMedia("(hover: none)").matches&&(giftCardFront.style.transform="rotateY(0deg)",giftCardBack.style.transform="rotateY(-180deg)",giftCard.addEventListener("click",()=>{"rotateY(0deg)"==giftCardFront.style.transform?(giftCardFront.style.transform="rotateY(-180deg)",giftCardBack.style.transform="rotateY(0deg)"):(giftCardFront.style.transform="rotateY(0deg)",giftCardBack.style.transform="rotateY(-180deg)")})),animateItems(),window.addEventListener("load",initSliders),upBtn&&(upBtn.onclick=(()=>{scrollTo(0,0)})),window.onscroll=(()=>{window.scrollY>1950?upBtn.classList.remove("hidden"):upBtn.classList.add("hidden")});